# 责任链模式

## 一、责任链模式

**意图：**避免请求发送者与接收者耦合在一起，让多个对象都有可能接收请求，将这些对象连接成一条链，并且沿着这条链传递请求，直到有对象处理它为止。

**主要解决：**职责链上的处理者负责处理请求，客户只需要将请求发送到职责链上即可，无须关心请求的处理细节和请求的传递，所以职责链将请求的发送者和请求的处理者解耦了。

**何时使用：**在处理消息的时候以过滤很多道。

**如何解决：**拦截的类都实现统一接口。

**关键代码：**Handler 里面聚合它自己，在 HandlerRequest 里判断是否合适，如果没达到条件则向下传递，向谁传递之前 set 进去。

## 二、优缺点

### 优点

- ###### 降低耦合度

  它将请求的发送者和接收者解耦。 

- ###### 简化对象

  使得对象不需要知道链的结构。 

- ###### 增强给对象指派职责的灵活性

  通过改变链内的成员或者调动它们的次序，允许动态地新增或者删除责任。 

- ###### 扩展性高

  增加新的请求处理类很方便。

### 缺点

- ###### 影响性能

  系统性能将受到一定影响，而且在进行代码调试时不太方便，可能会造成循环调用。 

- ###### 不利于排错

  可能不容易观察运行时的特征，有碍于除错。

## 三、应用

开源框架中的应用：

1. servlet 2.3 版新增了 Filter 和 FilterChain，其中 FilterChain 就是用了职责链模式：

   Filter 用于在 Servlet 响应前，进行预处理、信息校验等，Filter 没有调用 doFilter 方法参数中 chain 的 doFilter 方法，调用链即停止；

   FilterChain 接口中只有一个方法 doFilter，用于控制下一个 Filter 的方法被调用。

2. Spring 中的拦截器 HandlerInterceptor和HandlerExecutionChain，HandlerExecutionChain使用了责任链模式；

## 四、实现