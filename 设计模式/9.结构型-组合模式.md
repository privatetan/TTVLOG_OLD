# 组合模式

## 一、组合模式

**意图：**将对象组合成树形结构以表示"部分-整体"的层次结构。组合模式使得用户对单个对象和组合对象的使用具有一致性。

**主要解决：**树型结构的问题中，模糊了简单元素和复杂元素的概念，可以像处理简单元素一样来处理复杂元素，从而使得客户程序与复杂元素的内部结构解耦。

**何时使用：** 1、表示对象的部分-整体层次结构（树形结构）。 2、忽略组合对象与单个对象的不同，用户将统一地使用组合结构中的所有对象。

**如何解决：**树枝和叶子实现统一接口，树枝内部组合该接口。

**关键代码：**树枝内部组合该接口，并且含有内部属性 List，里面放 Component。

## 二、优缺点

### 优点

- ###### 高层模块调用简单。 

- ###### 节点自由增加。

### 缺点

- ###### 违反依赖倒置原则

  在使用组合模式时，其叶子和树枝的声明都是实现类，而不是接口。

## 三、应用

开源框架中的使用：

1. Mybatis 在处理 xml 动态 sql 中用到了组合模式：SqlNode 的实现类通过容器类与叶子节点构造成树形结构，使用 apply 动态解析出完整的 SQL。

## 四、实现